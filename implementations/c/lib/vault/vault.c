/**
 ********************************************************************************************************
 * @file  vault.c
 * @brief Wrapper functions for Vault Interface
 ********************************************************************************************************
 */

/*
 ********************************************************************************************************
 *                                             INCLUDE FILES                                            *
 ********************************************************************************************************
 */

#include "ockam/error.h"
#include "ockam/vault.h"

/*
 ********************************************************************************************************
 *                                                DEFINES                                               *
 ********************************************************************************************************
 */

#define VAULT_RAND_MAX_SIZE                         32u

/*
 ********************************************************************************************************
 *                                               CONSTANTS                                              *
 ********************************************************************************************************
 */

/*
 ********************************************************************************************************
 *                                               DATA TYPES                                             *
 ********************************************************************************************************
 */

/*
 ********************************************************************************************************
 *                                          FUNCTION PROTOTYPES                                         *
 ********************************************************************************************************
 */

/*
 ********************************************************************************************************
 *                                            GLOBAL VARIABLES                                          *
 ********************************************************************************************************
 */

/*
 ********************************************************************************************************
 *                                           GLOBAL FUNCTIONS                                           *
 ********************************************************************************************************
 */

/*
 ********************************************************************************************************
 *                                            LOCAL FUNCTIONS                                           *
 ********************************************************************************************************
 */


/**
 ****************************************************************************************************
 *                                          OckamVaultRandom()
 *
 * @brief   Generate a random number of desired size.
 *
 * @param   p_ctx[in]     Pointer to an initialized Vault context structure.
 *
 * @param   p_num[out]    Pointer to a buffer to store the generated random number. Must be able to
 *                        fit the requested random number.
 *
 * @param   num_size[in]  Size of the random number to generate.
 *
 * @return  kOckamErrorNone on success.
 ****************************************************************************************************
 */

OckamError OckamVaultRandom(void *p_ctx, uint8_t *p_num, size_t num_size)
{
  OckamError ret_val = kOckamErrorNone;
  OckamVaultCtx *p_vault_ctx = 0;

  if (p_ctx == 0) {
    ret_val = kOckamError;
    goto exit_block;
  }

  p_vault_ctx = p_ctx;

  if(p_vault_ctx->vault == 0) {
    ret_val = kOckamError;
    goto exit_block;
  }

  if ((p_num == 0) || (num_size > VAULT_RAND_MAX_SIZE)) {
    ret_val = kOckamError;
    goto exit_block;
  }

  ret_val = p_vault_ctx->vault->Random(p_ctx, p_num, num_size);

exit_block:
  return ret_val;
}
